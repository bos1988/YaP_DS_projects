# Рекомендация тарифов для телеком компании
> **Разработка системы рекомендации нового тарифа на основании данных о клиентах оператора связи.**

<br/>

### Описание:

Оператор мобильной связи выяснил: многие клиенты пользуются архивными тарифами. Они хотят построить систему, способную проанализировать поведение клиентов и предложить пользователям один из новых тарифов.

### Задачи:

- Построить модель для задачи классификации, которая выберет подходящий тариф.
- Постройте модель с максимально большим значением accuracy.

### Данные:

Предобработанные данные федерального оператора сотовой связи.

- ` сalls ` – количество звонков,
- ` minutes ` – суммарная длительность звонков в минутах,
- ` messages ` – количество sms-сообщений,
- ` mb_used ` – израсходованный интернет-трафик в Мб,
- ` is_ultra ` – каким тарифом пользовался в течение месяца («Ультра» – 1, «Смарт» – 0).

---

## v1:

### Используемые библиотеки:
*matplotlib<br/>numpy<br/>pandas<br/>random<br/>scipy<br/>seaborn<br/>sklearn*

### Ключевые аспекты:

*классификация<br/>подбор гиперпараметров<br/>выбор модели МО*

### Результат работы:

1. Решалась задача **классификации** для определния одного из двух подходящих тарифов на основаниия поведения клиентов.

1. Проведено исследование трех алгоритмов (решающее дерево, случайный лес и логистическая регрессия) для задачи классификации:
    - На результат работы обученной модели влияет разбивка исходных данных на обучающие и проверочные наборы данных;
    - Алгоритм "логистической регрессии" не подходит для исследуемого набора данных в силу низкой точности предсказаний;
    - С вероятностью не менее 99 % можно получить точность предсказаний более 0.75 на алгоритме **"решающее дерево"** с гиперпараметрами `max_depth` = **3**;
    - С вероятностью не менее 99,5 % можно получить точность предсказаний более 0.75 на алгоритме **"случайный лес"** с гиперпараметрами `n_estimators` = **6** и `max_depth` = **5**;
    - Лучшие средние значения точности прогнозов и вероятности более высоких значений точности можно получить на алгоритме **"случайный лес"** с гиперпараметрами `n_estimators` = **10** и `max_depth` = **9**

1. Получена рабочая модель на алгоритме **"случайный лес"** с гиперпараметрами `n_estimators` = **10** и `max_depth` = **9**, способная проанализировать поведение клиентов и предложить пользователям новый тариф: «Смарт» или «Ультра» с точнотью **80%**.

1. Рабочая модель прошла тестовую проверку и проверку на адекватность

### Table of contents:

<div class="toc"><ul class="toc-item"><li><span><a href="#Цель-проекта" data-toc-modified-id="Цель-проекта-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Цель проекта</a></span></li><li><span><a href="#Исходные-данные" data-toc-modified-id="Исходные-данные-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Исходные данные</a></span><ul class="toc-item"><li><span><a href="#Подключаемые-модули" data-toc-modified-id="Подключаемые-модули-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>Подключаемые модули</a></span></li><li><span><a href="#Функции" data-toc-modified-id="Функции-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>Функции</a></span></li></ul></li><li><span><a href="#Исходные-данные" data-toc-modified-id="Исходные-данные-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Исходные данные</a></span><ul class="toc-item"><li><span><a href="#Чтение-данных" data-toc-modified-id="Чтение-данных-3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span>Чтение данных</a></span></li><li><span><a href="#Описание-данных" data-toc-modified-id="Описание-данных-3.2"><span class="toc-item-num">3.2&nbsp;&nbsp;</span>Описание данных</a></span></li><li><span><a href="#Общая-информация" data-toc-modified-id="Общая-информация-3.3"><span class="toc-item-num">3.3&nbsp;&nbsp;</span>Общая информация</a></span></li><li><span><a href="#Выводы" data-toc-modified-id="Выводы-3.4"><span class="toc-item-num">3.4&nbsp;&nbsp;</span>Выводы</a></span></li></ul></li><li><span><a href="#Исследование-моделей" data-toc-modified-id="Исследование-моделей-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Исследование моделей</a></span><ul class="toc-item"><li><span><a href="#Тестовая-часть-из-данных" data-toc-modified-id="Тестовая-часть-из-данных-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>Тестовая часть из данных</a></span></li><li><span><a href="#Проверка-влияния-разбивки-на-точность-модели" data-toc-modified-id="Проверка-влияния-разбивки-на-точность-модели-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>Проверка влияния разбивки на точность модели</a></span></li><li><span><a href="#Поиск-оптимальных-гимперпараметров-на-различных-алогритмах-классификации" data-toc-modified-id="Поиск-оптимальных-гимперпараметров-на-различных-алогритмах-классификации-4.3"><span class="toc-item-num">4.3&nbsp;&nbsp;</span>Поиск оптимальных гимперпараметров на различных алогритмах классификации</a></span><ul class="toc-item"><li><span><a href="#РЕШАЮЩЕЕ-ДЕРЕВО" data-toc-modified-id="РЕШАЮЩЕЕ-ДЕРЕВО-4.3.1"><span class="toc-item-num">4.3.1&nbsp;&nbsp;</span>РЕШАЮЩЕЕ ДЕРЕВО</a></span></li><li><span><a href="#СЛУЧАЙНЫЙ-ЛЕС" data-toc-modified-id="СЛУЧАЙНЫЙ-ЛЕС-4.3.2"><span class="toc-item-num">4.3.2&nbsp;&nbsp;</span>СЛУЧАЙНЫЙ ЛЕС</a></span></li><li><span><a href="#ЛОГИСТИЧЕСКАЯ-РЕГРЕССИЯ" data-toc-modified-id="ЛОГИСТИЧЕСКАЯ-РЕГРЕССИЯ-4.3.3"><span class="toc-item-num">4.3.3&nbsp;&nbsp;</span>ЛОГИСТИЧЕСКАЯ РЕГРЕССИЯ</a></span></li></ul></li><li><span><a href="#Выводы" data-toc-modified-id="Выводы-4.4"><span class="toc-item-num">4.4&nbsp;&nbsp;</span>Выводы</a></span></li></ul></li><li><span><a href="#Разбивка-данных-на-выборки" data-toc-modified-id="Разбивка-данных-на-выборки-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>Разбивка данных на выборки</a></span></li><li><span><a href="#Исследование-моделей" data-toc-modified-id="Исследование-моделей-6"><span class="toc-item-num">6&nbsp;&nbsp;</span>Исследование моделей</a></span></li><li><span><a href="#Проверка-модели-на-тестовой-выборке" data-toc-modified-id="Проверка-модели-на-тестовой-выборке-7"><span class="toc-item-num">7&nbsp;&nbsp;</span>Проверка модели на тестовой выборке</a></span></li><li><span><a href="#Проверка-модели-на-адекватность" data-toc-modified-id="Проверка-модели-на-адекватность-8"><span class="toc-item-num">8&nbsp;&nbsp;</span>Проверка модели на адекватность</a></span></li><li><span><a href="#Выводы" data-toc-modified-id="Выводы-9"><span class="toc-item-num">9&nbsp;&nbsp;</span>Выводы</a></span></li></ul></div>
